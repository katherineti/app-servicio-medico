<div class="login-container">
  <div class="row no-gutters h-100">
    
    <!-- Columna Izquierda - Imagen completa -->
    <div class="col-xl-8 col-lg-7 col-md-7 d-none d-md-flex background-column">
      <!-- La imagen de fondo se maneja en CSS -->
    </div>

    <!-- Columna Derecha - Formulario -->
    <div class="col-xl-4 col-lg-5 col-md-5 col-12 form-column">
      <div class="form-container">
        <div class="form-content">
          
          <!-- Header -->
          <div class="text-center header-section">
            <h2 class="welcome-title">Restablecer Contraseña</h2>
            <p class="welcome-subtitle" *ngIf="!emailSent">
              Ingresa tu email para recibir instrucciones
            </p>
          </div>

          <!-- Mensaje de éxito -->
          <div *ngIf="emailSent" class="success-message">
            <mat-icon class="success-icon">check_circle</mat-icon>
            <h3>Correo enviado</h3>
            <p>Hemos enviado un enlace de restablecimiento a:</p>
            <p class="email-display"><strong>{{ sentEmail }}</strong></p>
            <p class="instructions">
              Por favor, revisa tu bandeja de entrada y sigue las instrucciones en el correo.
            </p>
          </div>

          <!-- Formulario -->
          <form *ngIf="!emailSent"
                class="forgot-password-form" 
                [formGroup]="forgotPasswordFormGroup" 
                (ngSubmit)="sendRecoveryEmail()"
                novalidate>
            
            <!-- Campo Email -->
            <div class="form-group">
              <mat-form-field appearance="outline" class="w-100" color="primary">
                <mat-label>Email</mat-label>
                <input
                  matInput
                  placeholder="Ingresa tu email"
                  formControlName="email"
                  required
                  type="email"
                  autocomplete="email"
                  [disabled]="isLoading"
                />
                <mat-error *ngIf="forgotPasswordFormGroup.controls['email'].hasError('required')">
                  El email es requerido.
                </mat-error>
                <mat-error *ngIf="forgotPasswordFormGroup.controls['email'].hasError('email')">
                  Por favor, introduce un email válido.
                </mat-error>
              </mat-form-field>
            </div>
            
            <!-- Botón Enviar -->
            <button 
              type="submit"
              class="forgot-password-button" 
              [class.loading]="isLoading"
              mat-flat-button 
              color="primary" 
              [disabled]="!forgotPasswordFormGroup.valid || isLoading">
              <span *ngIf="!isLoading">Enviar enlace de recuperación</span>
              <span *ngIf="isLoading">Enviando...</span>
            </button>
          </form>

          <!-- Botones de acción después del envío -->
          <div *ngIf="emailSent" class="action-buttons">
            <button 
              type="button"
              class="resend-button" 
              mat-stroked-button 
              color="primary"
              (click)="resendEmail()">
              Enviar de nuevo
            </button>
          </div>

          <!-- Link de vuelta al login -->
          <div class="login-link">
            <a [routerLink]="['/login']" class="login-anchor">
              ← Volver al inicio de sesión
            </a>
          </div>

        </div>
      </div>
    </div>

  </div>
</div>
